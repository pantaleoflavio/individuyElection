# Usa una base Ubuntu 18.04 per il nostro server di staging
FROM ubuntu:18.04

# Aggiorna e installa i pacchetti necessari
RUN apt-get update && apt-get install -y \
    npm \
    nodejs \
    php8.1 \
    mariadb-server \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Installa una versione specifica di Node.js
RUN npm install -g n
RUN n 20.10.00

# Installa Composer
RUN php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
RUN php composer-setup.php --install-dir=/usr/local/bin --filename=composer
RUN php -r "unlink('composer-setup.php');"

# Espone il webserver nel server di staging come link sicuro.
# Ogni volta che qualcuno clicca sul link, caricheremo questo server di staging e inoltreremo
# le loro richieste ad esso.
EXPOSE WEBSITE http://localhost:80
